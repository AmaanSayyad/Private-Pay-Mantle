# Progressive Web App (PWA) Setup

## Overview

PrivatePay has been configured as a Progressive Web App (PWA), allowing users to install it on their mobile devices and desktop browsers for a native app-like experience.

## Features Implemented

### 1. **Web App Manifest**
- App name, icons, and theme colors configured
- Standalone display mode for native app experience
- Shortcuts for quick access to Send Payment and Payment Links
- Support for iOS and Android home screen installation

### 2. **Service Worker**
- Automatic service worker registration
- Offline caching for static assets
- Network-first caching for Supabase API calls
- Network-first caching for Mantle RPC calls
- Automatic updates when new versions are available

### 3. **Push Notifications**
- Payment received notifications
- Browser notification support
- Permission request handling
- Click-to-open functionality

### 4. **Installation Prompt**
- Automatic detection of install capability
- PWA installation detection
- Support for "Add to Home Screen" on mobile devices

## Installation

### For Users

#### Mobile (iOS):
1. Open PrivatePay in Safari
2. Tap the Share button
3. Select "Add to Home Screen"
4. Confirm the installation

#### Mobile (Android):
1. Open PrivatePay in Chrome
2. Tap the menu (three dots)
3. Select "Add to Home Screen" or "Install App"
4. Confirm the installation

#### Desktop (Chrome/Edge):
1. Look for the install icon in the address bar
2. Click "Install" when prompted
3. The app will open in a standalone window

## Technical Details

### Service Worker
- Location: Automatically generated by `vite-plugin-pwa`
- Registration: Handled in `src/utils/pwa-utils.js`
- Caching Strategy: Network-first for API calls, cache-first for static assets

### Push Notifications
- Permission: Requested on first user interaction
- Triggers: Payment received events
- Format: Shows amount and sender address (truncated)

### Manifest Configuration
- Theme Color: `#0d08e3` (Primary blue)
- Background Color: `#ffffff` (White)
- Display Mode: `standalone`
- Orientation: `portrait-primary`

## Development

### Testing PWA Locally

1. Build the app:
   ```bash
   npm run build
   ```

2. Preview the build:
   ```bash
   npm run preview
   ```

3. Test service worker:
   - Open DevTools > Application > Service Workers
   - Verify service worker is registered
   - Test offline functionality

### Testing Notifications

1. Grant notification permission in browser
2. Trigger a payment received event
3. Verify notification appears

### Testing Installation

1. Use Chrome DevTools > Application > Manifest
2. Check for install prompt availability
3. Test on actual mobile devices for best results

## Browser Support

- ✅ Chrome/Edge (Desktop & Mobile)
- ✅ Safari (iOS 11.3+)
- ✅ Firefox (Desktop)
- ✅ Samsung Internet
- ⚠️ Notifications: Chrome, Firefox, Edge (Safari has limited support)

## Configuration Files

- `vite.config.js` - PWA plugin configuration
- `public/manifest.json` - Web app manifest
- `src/utils/pwa-utils.js` - PWA utility functions
- `index.html` - PWA meta tags

## Future Enhancements

- [ ] Background sync for offline payments
- [ ] Periodic background sync for balance updates
- [ ] Share target API for receiving payment links
- [ ] Badge API for unread payment notifications
- [ ] Web Share API integration
